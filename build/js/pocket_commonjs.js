module.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var o=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,a=[t,r],o=s(o=e),function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return!!t}()?Reflect.construct(o,a||[],s(n).constructor):o.apply(n,a));var n,o,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(r(1));t.exports=o},function(t,e,r){r(2),r(7);const{copy:i,warn:s,isArray:n,onerror:o,objectSize:a,isString:c,uniq:u,isFunction:h}=r(3),{validProbe:l,validProjectID:d}=r(8),p=r(9);t.exports=class extends p{constructor(t,e){super(t,e)}$architect(t,e){return super.architect(t,e)}$asset(t,e,r){return super.asset(t,e,r)}$exists(t){return!!this.selectByTask(t)}$projectComplete(t){return this.projectsCache[t]?"complete"===this.projectsCache[t]:null}$projectSet(t=""){return t=d(t),!!this.payloadData[t]}$condition(t,e){if(!h(t))return this.debug&&s("[pocket]","[$condition] must provide callback"),this;let r="PocketSelf",i=null;if(0===(e=c(e)?e:"").indexOf("::")){if(e=this.selectByTask(e,!0),r="ProbeSelf",!(e=this.lastProbeID(e)))return this.debug&&s("[pocket]","[$condition] probeID not found"),this}else{if(!this.lastProjectID(e))return this.debug&&s("[pocket]","[$condition] projectID not found"),this;r="PocketSelf"}if("PocketSelf"===r&&(i=this),"ProbeSelf"===r&&(i=this.$get(e)),!i)return this.debug&&s("[pocket]","[$condition] no valid self value"),this;return t.call(i,i)||this}get $projectID(){return this._lastProjectID}$probeStatusAsync(t=""){t=this.selectByTask(t,!0);let e=this.lastProbeID(t);return super.probeStatusAsync(e)}$get(t,e){t=this.selectByTask(t,!0);let r=this.lastProbeID(t);return super._get(r,e)}$getByRef(t=""){return Object.assign(this.pocket).filter(([e,r],i)=>r.ref===t)}$set(t,e){e=this.selectByTask(e,!0);let r=this.lastProbeID(e);return super._set(t,r)}$probe(t=""){t=this.selectByTask(t,!0);let e=this.lastProbeID(t);if(this.pocket[e]){if("Probe"===this.pocket[e].constructor.name)return this.pocket[e];this.debug&&o("[pocket]",`[$probe] probeID: ${t} is not an instance of Probe{}`)}else this.debug&&s("[pocket]","[$probe] not found for probeID: "+t)}$update(t,e,r){r=this.selectByTask(r,!0);let i=this.lastProbeID(r);return super.update(t,e,i)}$select(t){return t=c(t)?t:"",this.lastProjectID(t),this}$filter(t,e){const r=this;e=this.lastProjectID(e);const i=t=>(this.d=(t||[]).filter(t=>void 0===t.isNONE),r);if(!h(t))return i([]);if(!this.payloadData[e])return this.debug&&s("[pocket]","[$filter] no projectID found"),i(null);let n=[];return(this._lastFilterList[e]||[]).length?n=this._lastFilterList[e]:(this._lastFilterList[e]=[],n=this.projectProbeList(e)),n.forEach((r,i)=>{if(r.isNONE)return;const s=t.call(r,r);if(!s)return this._lastFilterList[e]=this._lastFilterList[e].filter(t=>t.id!==r.id),void this._lastFilterList[e].push({id:r.id,isNONE:!0});void 0===s||!0!==s&&1!==s?this._lastFilterList[e].push({id:r.id,isNONE:!0}):this._lastFilterList[e].filter((t,e)=>(t||{}).id===r.id).length||this._lastFilterList[e].push(r)}),i(this._lastFilterList[e])}$compute(t,e=""){e=this.lastProjectID(e);const r=t=>(t&&delete this._lastFilterList[e],this.d=t,this);if(!h(t))return this.debug&&s("[pocket]","[$compute] cb must be a function"),r(null);if(!this.payloadData[e])return this.debug&&s("[pocket]","[$compute] no project found fo your/last id projectID:"+e),r(null);let i=this._lastFilterList[e]||[];return i.length?(this._lastFilterList[e]=i=i.filter(t=>void 0===t.isNONE).filter(({id:t},e,r)=>1===r.filter(e=>t===e.id).length),i.forEach(e=>{"complete"!==e.status&&"send"!==e.status&&t.call(e,e)}),r(this._lastFilterList[e])):(this.projectProbeList(e).forEach(e=>{"complete"!==e.status&&"send"!==e.status&&t.call(e,e)}),r(this.projectProbeList(e)))}$list(t="",e=null,r="self"){if(t=this.lastProjectID(t),!this.payloadData[t])return[];const i=()=>Object.entries(this.pocket).reduce((e,[r,i],s)=>(i.id.includes(t)&&e.push(i),e),[]);return h(e)?(this.projectProbeList(t).forEach(t=>{e(t.all())}),"self"!==r&&r?"list"===r?i():void 0:this):i()}$transfer(t=""){return t=this.selectByTask(t,!0),t=this.lastProbeID(t),this.pocket[t]?(this.storeTransfers(t,i(this.pocket[t].data)),this.$transfer_lastID=t,this):(this.debug&&s("[pocket]","[$transfer] no Probe{} found for this id fromProbeID:"+t),this)}$to(t="",e=!0,r=100){if(t=this.selectByTask(t,e),e&&(t=l(t)),!t)return this.debug&&s("[pocket]","[$to] toProbeID is invalid"),this;if(!this.pocket[t])return this.debug&&s("[pocket]","[$to] no Probe{} found for this id toProbeID:"+t),this;if(this.$transfer_lastID){const e=this.accessLastValidTransfer(r);if(a(e)){const{fromProbeID:r,data:i}=e;if(this.$transfer_lastID===r){if("complete"===this.pocket[t].status||"send"===this.pocket[t].status)return this.debug&&s("[pocket]",`[$to] cannot transfer since toProbeID: ${t} is already complete`),this.$transfer_lastID="",this;this.pocket[r].data=null,this.pocket[t].data=i}}else this.debug&&s("[pocket]","[$to] no last valid transfer found");this.$transfer_lastID=""}return this}$of(t=""){return this.selectByTask(t,!0),this}$data(t,e="",r=!1){return e=this.selectByTask(e,!0),this.pocket[e]?(n(t)&&(t||[]).length&&(t=u(t).reduce((t,e)=>(void 0!==e&&(t[e.trim()]=!0),t),{})),t&&a(t)?this.dataPropSelector("data()",e,t,r,i(this.pocket[e].data)):(this._$cached_data[e]=i(this.pocket[e].data),r?this:this._$cached_data[e])):r?this:void 0}$cached(t={},e=""){if(e=this.selectByTask(e,!0),!this.pocket[e])return;const r=void 0!==this._$cached_data[e]&&null!==this._$cached_data[e];return r?(c(t)&&(t||"").length&&(t=u(t.trim().replace(/ /gi,"").split(",")).reduce((t,e)=>(void 0!==e&&(t[e]=!0),t),{})),!a(this._$cached_data[e])&&r?a(t)?void 0:this._$cached_data[e]:t&&a(t)?this.dataPropSelector("cached()",e,t,!1,this._$cached_data[e]):void 0===this._$cached_data[e]?void 0:this._$cached_data[e]):void 0}$campaign(t){return t=this.selectByTask(t,!0),this.pocket[t]?i(this.pocket[t].campaign):null}$ref(t){if(t=this.selectByTask(t,!0),this.pocket[t])return i(this.pocket[t].ref)}$status(t){if(t=this.selectByTask(t,!0),this.pocket[t])return i(this.pocket[t].status)}$task(t){if(t=this.selectByTask(t,!0),this.pocket[t])return i(this.pocket[t].task)}$error(t){if(t=this.selectByTask(t,!0),this.pocket[t])return i(this.pocket[t].error)}$all(t){if(t=this.selectByTask(t,!0),this.pocket[t])return i(this.pocket[t].all())}$onChange(t,e,r){return this._onChange?(r=this.selectByTask(r,!0),this.pocket[r]?(this.pocket[r].onChange(t,e),this):null):(this.debug&&s("[pocket]","[$onChange] opts.onChange=true must be enabled to use this feature"),this)}$onProbeComplete(t,e){if(!this._onChange)return this.debug&&s("[pocket]","[$onChange] opts.onChange=true must be enabled to use this feature"),this;if(e){if(e=this.selectByTask(e,!0),!this.pocket[e])return;return this.pocket[e].onChange(t,"status:complete"),this}{let e=this.lastProjectID();return this.projectProbeList(e).forEach(e=>{e.onChange(t,"status:complete")}),this}}}},function(t,e,r){const{isString:i,sq:s,isArray:n,warn:o,log:a,isNumber:c,onerror:u,last:h,copy:l,isObject:d,isFunction:p,dispatcher:f}=r(3),g=r(6);t.exports=class extends g{constructor(t,e={},r){if(super(t,e,r),this.debug=r||!1,(c(t.id)||t.id)&&(t.id=t.id.toString()),!t.task||!i(t.task))throw"task as string is required";this._id=null,this._error=[],this._ref=null,this._task=null,this._status=null,this._data=null,this._campaign=null,this._dataIndex=0,this._statusIndex=0,this._statusAsync=[],this.task=t.task,this.id=t.id,this.status="open",this._sealed=!1,this._onChange=e.onChange||null,this._onchangeDispatch=void 0,this.emitter=e.emitter||null,this.withDataBank=e.withDataBank||!1,this.completeOnNull=e.completeOnNull||null,this.disableWarnings=(e||{}).disableWarnings,t.ref!==this._ref&&(this.ref=t.ref),t.data!==this._data&&(this.data=t.data),t.campaign&&(this.campaign=t.campaign),this._completeAsync=s()}get sq(){return this._sq||(this._sq=s()),this._sq}set id(t){if(this._id)return void(this.debug&&o("[pocket]","cannot update already set id: "+this._id));if(!t)throw"id is required";if(t.split(" ").length>1)throw"each id cannot have spaces";if(-1===t.indexOf("::"))throw"each id must be of format id::taskName";if(-1!==t.indexOf(":::"))throw"each id must be of format id::taskName";const e=/[`~!@#$%^&*()\=?;'",.<>\{\}\[\]\\\/]/gi;if(new RegExp(e,"gi").test(t))throw"your id is invalid, allowed chars: "+e;if(-1===(t=t.replace(/ /gi,"_").toLowerCase()).indexOf(this._task))throw"wrong id setup, your id should make up the task name, example: id='cocacola::drink'";this._id=t}get id(){return this._id}set error(t){t&&(this._error.push(n(t)?t.toString():t),this._error=this._error.filter(t=>!!t),this.dispatchChange("error"))}get error(){if(this._error.length)return this._error}get ref(){return this._ref}set ref(t){t&&(i(t)?"complete"!==this.status&&"send"!==this.status&&(this._ref=t,this.dispatchChange("ref")):o("[pocket]","[ref] must be a string"))}get campaign(){return this._campaign}set campaign(t){void 0!==t&&(this._campaign?this.debug&&!this.disableWarnings&&o("[pocket]","cannot update already set campaign "+this._campaign):t&&(i(t)?(this._campaign=t,this.dispatchChange("campaign")):this.debug&&o("[pocket]","campaign must be a string",t)))}set task(t){if(void 0===t)return;if(this._task)return void(this.debug&&!this.disableWarnings&&o("[pocket]","cannot update already set task"));if(!t)return;if(!i(t))return void(this.debug&&o("[pocket]","task must be a string"));if(-1!==t.indexOf("::"))throw"task separator :: is restricted";if(t.split(" ").length>1)throw"task cannot have spaces, use separators: _+";const e=/[`~!@#$%^&*()\=?;'",.<>\{\}\[\]\\\/]/gi;if(new RegExp(e,"gi").test(t))throw"your task is invalid, allowed chars: "+e;this._task=t.replace(/ /gi,"_").toLowerCase()}get task(){return this._task}set data(t){void 0!==t&&("complete"===this.status||"send"===this.status?this.debug&&!this.disableWarnings&&o("[pocket]","you cannot update data once the status is complete or send"):(this._dataIndex++,"open"===this.status&&null!==this._data&&this._dataIndex>1&&(this.status="updated"),this._data=t,this.withDataBank&&(this.dataBank=t),this.dispatchChange("data")))}get data(){return this._data}update(t,e=null){return"complete"===this.status||"send"===this.status?(this.debug&&!this.disableWarnings&&o("[Probe][update] cannot update data on complete status"),this):!d(t)&&e?(this.debug&&o("[pocket]","[Probe][update] cannot update none object 'data' with option 'merge=true' set"),this):(d(t)&&e?this.data=Object.assign({},this.data,t):void 0!==t&&(this.data=t),this)}get statusStackOrder(){return{open:{value:1,set:!1},updated:{value:2,set:!1},complete:{value:3,set:!1},send:{value:4,set:!1},error:{value:5,set:!1}}}get status(){return this._status}set status(t){(e=>{try{if(this.statusStackOrder[e].value>2&&!0===this.statusStackOrder[e].set)return!1}catch(t){u("statusStackOrder invalid status")}switch(e){case"open":if("updated"===this._status){this.debug&&o("[pocket]","cannot set status back to open once set to updated");break}this._status=e,this.statusStackOrder[e].set=!0,this.onOpenStatus(t),this.setStatusAsync=e,this.dispatchChange("status");break;case"updated":if("complete"===this._status){this.debug&&o("[pocket]","cannot update status to 'updated' then previously set to 'complete'");break}this._dataIndex>0&&(this._status=e,this.statusStackOrder[e].set=!0,this.setStatusAsync=e,this.dispatchChange("status"),this.debug&&a(`id:${this.id}, data updated`));break;case"complete":if(null===this.data&&!0!==this.completeOnNull){this.debug&&o("[pocket]","[status] cannot complete status because data is null, to complete you set data prop to false");break}this.statusStackOrder[e].set=!0,this.setStatusAsync=e,this._status=e,this.dispatchChange("status"),this.onComplete(t);break;case"send":if("complete"!==this._status){this.debug&&o("[pocket]","cannot update status to 'send' then previously not set to 'complete'");break}this._status=e,this.statusStackOrder[e].set=!0,this.setStatusAsync=e,this._completeAsync.resolve({status:this._status,id:this.id}),this.dispatchChange("status");break;case"error":if("complete"===this._status)return;this.statusStackOrder[e].set=!0,this.setStatusAsync=e,this.dispatchChange("status"),this.onComplete(t);break;default:this.debug&&o("[pocket]",`id:${this.id},  you set invalid status: ${e}, nothing changed`)}})(t)}set setStatusAsync(t){const e={timestamp:(new Date).getTime(),p:s()};this._statusAsync.push(e)}get setStatusAsync(){const t=h(this._statusAsync.sort((t,e)=>t.timestamp-e.timestamp).map(t=>t.p));return t.resolve(l(this.status)),t}get getStatusAsync(){return this.setStatusAsync.promise}get completeAsync(){return this._completeAsync.promise}get statusAsync(){return this.getStatusAsync}all(){const t={error:this.error,ref:this.ref,campaign:this.campaign,data:this.data,id:this.id,task:this.task,status:this.status};return this.withDataBank&&(t.dataBank=l(this.dataBank)),t}onChange(t,e="all"){if(!this._onChange)return this.debug&&o("[pocket]","[onChange] to use need to set opts.onChange=true"),this;if(!p(t))return this.debug&&o("[onChange] cb must be a function"),this;let r=["all","data","status","ref","error","campaign"];if(r=[].concat(r,["status:complete"]),!r.includes(e))return this.debug&&o("[pocket]","[onChange] no watch available for "+e),this;let i=r.indexOf("status:complete");r.splice(i,1);const s=this;return this.onchangeDispatch?(this.onchangeDispatch.subscribe((function(r,i){if(r.changed&&"all"===e)t.bind(s)(s,i);else{if("status:complete"===e){if("status"===r.changed&&("send"===s.status||"complete"===s.status)&&!s._sealed){let e={...l(s),status:"complete"};t.bind(s)(e,i),s._sealed=!0}return this}r.changed===e&&void 0!==s[e]&&t.bind(s)(s[e],i)}})),this):(this.debug&&o("[pocket]","[onChange] onchangeDispatch no longer active"),this)}dispatchChange(t){return!!this._onChange&&!!this.onchangeDispatch&&(this.onchangeDispatch.next({changed:t}),!0)}get onchangeDispatch(){return this._onChange?(this._onchangeDispatch||(this._onchangeDispatch=f(this.id)),this._onchangeDispatch):(this.debug&&o("[pocket]","[onchangeDispatch] to use need to set opts.onChange=true"),null)}onComplete(t){return"complete"!==t&&"error"!==t||"send"===this._status||!(this._dataIndex>0||!0===this.completeOnNull)||(this.emitter&&setTimeout(()=>{this.emitter({probe:this,status:t})}),this._status="send",this.sq.resolve({probe:this.all()}),setTimeout(()=>{this.onchangeDispatch&&this.onchangeDispatch.del()})),this}onOpenStatus(t){return"open"===t&&this.emitter&&setTimeout(()=>{this.emitter({probe:this,status:"open"})}),this}}},function(t,e,r){"use strict";(function(r,i){var s,n,o,a;(function(){try{globalThis||r||window}catch(t){}})(),a=function(t,e){var s=Number.prototype,n=String.prototype;function o(t,e,r,i,s,n,o){try{var a=t[n](o),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(i,s)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(i,s){function n(t){o(c,i,s,n,a,"next",t)}function a(t){o(c,i,s,n,a,"throw",t)}var c=t.apply(e,r);n(void 0)}))}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r,i=0;i<e.length;i++)(r=e[i]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function l(t){var e=g();return function(){var r,i=v(t);if(e){var s=v(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){var e="function"==typeof Map?new Map:void 0;return(p=function(t){function r(){return f(t,arguments,v(this).constructor)}if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),y(r,t)})(t)}function f(){return(f=g()?Reflect.construct:function(t,e,r){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return r&&y(s,r.prototype),s}).apply(null,arguments)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){var r=this,i="[dispatcher]";this.uid=((t||"").toString()||(new Date).getTime()).toString(),this.debug=e,this.cbQueue={},this.dispatchInstance={},this._isActive=null,this._onComplete_cb=null,this.index=0,this.data=null,this.onComplete=t=>(this._onComplete_cb=t,this),this.initListener=()=>(this.Dispatch(),this._isActive=!0,this),this.next=function(t){return void 0===t&&(t=null),!1!==r._isActive&&r.initListener(),r.dispatchInstance[r.uid]?r.dispatchInstance[r.uid].next(t):r.debug&&$({message:i+" for uid not available",uid:r.uid}),r},this.Dispatch=()=>{if(this.dispatchInstance[this.uid])return this;var t=this;return this.dispatchInstance[this.uid]||(this.dispatchInstance[this.uid]=new function(){this.uid=t.uid,this.data=null,this.next=e=>("cb"!==(e||{}).type&&(this.data=e),"cb"===(e||{}).type?void("function"==typeof e.cb&&(!t.cbQueue[t.uid]&&(t.cbQueue[t.uid]=e.cb),this.data&&(t.index++,t.data=this.data,e.cb.call(t,this.data,t.uid,t.index)))):void(this.data?"function"==typeof t.cbQueue[t.uid]&&(t.index++,t.data=this.data,t.cbQueue[t.uid].call(t,this.data,t.uid,t.index)):t.debug&&I(i+" no callback data")))}),this},this.isActive=()=>this._isActive,this.del=()=>(delete this.cbQueue[this.uid],delete this.dispatchInstance[this.uid],this._isActive=!1,"function"==typeof this._onComplete_cb&&this._onComplete_cb(this.uid),this),this.subscribe=t=>"function"==typeof t?(this.dispatchInstance[this.uid]||this.Dispatch(),this.dispatchInstance[this.uid]&&this.dispatchInstance[this.uid].next({type:"cb",cb:t}),this):(this.debug&&I(i+"[subscribe] cb must be set"),this),this.init=this.initListener,this.sub=this.subscribe,this.emit=this.next,this.delete=this.del,this.unsubscribe=this.del}Object.defineProperty(e,"__esModule",{value:!0});var b,m,k,j,w=(m=(b=Object).getPrototypeOf||function(t){return t.__proto__},k=b.setPrototypeOf||function(t,e){return t.__proto__=e,t},j="object"==typeof Reflect?Reflect.construct:function(t,e,r){var i,s=[null];return s.push.apply(s,e),i=t.bind.apply(t,s),k(new i,r.prototype)},function(t){var e=m(t);return k(t,k((function(){return j(e,arguments,m(this).constructor)}),e))}),D=()=>{try{if("test"===(i.env||{}).NODE_ENV)return!1;if(window)return!0}catch(t){return!1}},O=function(t){void 0===t&&(t=void 0);try{if(D())return window.xUtilsConfig||(window.xUtilsConfig={}),window.xUtilsConfig?"off"===window.xUtilsConfig.logging?"off":(window.xUtilsConfig[t]?window.xUtilsConfig[t]:"on").toString():"on"}catch(t){}try{return r.xUtilsConfig||(r.xUtilsConfig={}),r.xUtilsConfig?"off"===r.xUtilsConfig.logging?"off":(r.xUtilsConfig[t]?r.xUtilsConfig[t]:"on").toString():"on"}catch(t){}return"on"},P=()=>{try{if(D())return"on"===(window.xUtilsConfig||{}).logging||void 0===(window.xUtilsConfig||{}).logging}catch(t){}try{return"on"===(r.xUtilsConfig||{}).logging||void 0===(r.xUtilsConfig||{}).logging}catch(t){}return!0},x=function(t){if(void 0===t&&(t=void 0),"function"!=typeof t)return!1;try{var e=t();return!0===e||0<e}catch(t){return!1}},S=function(t,e){void 0===t&&(t=""),e.length||(e[0]="");var r=0===e.filter(t=>"string"==typeof t||void 0===t).length?"%o":"";"log"===t&&(e=[].concat("[90m[log][0m[2m"+r+" ",e,"[0m")),"debug"===t&&(e=[].concat("[90m[debug][0m[32m"+r+" ",e,"[0m")),"warn"===t&&(e=[].concat("[90m[warning][0m[1m"+r+" ",e,"[0m")),"alert"===t&&(e=[].concat("[90m[alert][0m[33m"+r+" ",e,"[0m")),"attention"===t&&(e=[].concat("[90m[attention][0m[36m"+r+" ",e,"[0m")),console.log.apply(null,e)},$=function(){if(P()&&"off"!==O("log")){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return S("log",e)}},I=function(){if(P()&&"off"!==O("warn")){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return S("warn",e)}},C=function(){if(!D()&&P()&&"off"!==O("alert")){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return S("alert",e)}},A=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(P()&&"off"!==O("error")&&"off"!==O("onerror")){e.length||(e[0]="");var i=0===e.filter(t=>"string"==typeof t||void 0===t).length,s=i?"%o":"";try{if(D())return e=[].concat("[31m[error][0m[31m"+s+" ",e,"[0m"),void console.error.apply(null,e)}catch(t){}e=[].concat("[41m[error][0m[31m"+s+" ",e,"[0m"),console.error.apply(null,e)}},T=A,N=function(t){return void 0===t&&(t=void 0),"function"==typeof t},E=t=>"bigint"==typeof t,L=function(t,e){return void 0===t&&(t=void 0),void 0===e&&(e=void 0),(!N(e)||x(e))&&!E(t)&&!!t&&Array.prototype===t.__proto__},B=function(t,e){void 0===e&&(e=!0);var r=r=>e?typeof t:r||typeof t,i=e=>e.prototype===t.prototype;try{return"symbol"==typeof t?{type:r(),value:0,primitiveValue:Symbol("")}:void 0===t?{type:r(),value:0,primitiveValue:void 0}:"boolean"==typeof t?{type:r(),value:+t,primitiveValue:Boolean()}:"bigint"==typeof t&&"object"==typeof Object(t)?{type:r(),value:1,primitiveValue:BigInt("")}:null===t?{type:r("null"),value:0,primitiveValue:{}}:t.__proto__===Date.prototype||i(Date)?{type:r("date"),value:1,primitiveValue:new Date}:n===t.__proto__?{type:r(),value:t.length,primitiveValue:String()}:Array.prototype===t.__proto__||i(Array)?{type:r("array"),value:(t||[]).length,primitiveValue:[]}:Promise.prototype===(t||"").__proto__||i(Promise)?{type:r("promise"),value:1,primitiveValue:Function}:Function.prototype===t.__proto__||i(Function)?{type:r(),value:1,primitiveValue:Function}:Object.prototype===t.__proto__||i(Object)?{type:r(),value:Object.keys(t).length,primitiveValue:{}}:Error.prototype===t.__proto__||i(Error)?{type:r("error"),value:Object.keys(t).length,primitiveValue:Error()}:t.__proto__===s||i(Number)?isNaN(t)?{type:r("NaN"),value:0,primitiveValue:Number()}:{type:r(),value:t,primitiveValue:Number()}:0==0<=+t?{type:typeof t,value:+t,primitiveValue:void 0}:{type:typeof t,value:0,primitiveValue:void 0}}catch(t){return T(t),{}}},F=t=>{if(void 0===t)return!1;if(null===t)return!1;if(!0===t||!1===t)return!0;try{if(t instanceof Boolean)return!0}catch(t){}return!1},R=t=>null===t,U=t=>void 0===t,V=t=>{if(E(t))return!1;try{if(t instanceof Number)return!0}catch(t){}return!(null==t||""===t)&&t.__proto__===s},W=function(t){return void 0===t&&(t=""),null!=t&&t.__proto__===n?t.length:0},q=function(t){void 0===t&&(t=void 0);try{if(1==(void 0!==t.promise&&"function"==typeof t.resolve&&"function"==typeof t.reject&&"function"==typeof t.fulfill&&"function"==typeof t.notify))return!0}catch(t){}return!1},M=t=>{try{return"SimpleQ"===t.entity}catch(t){return!1}},Q=t=>{if(q(t))return!0;try{if(t instanceof Promise)return!0}catch(t){}return!1},J=function(t,e){if(void 0===t&&(t=void 0),void 0===e&&(e=void 0),N(e)&&!x(e))return!1;if(E(t))return!1;if(isNaN(t)&&"number"==typeof t)return!1;if("function"==typeof t)return!1;if(!isNaN(+t)||void 0===t)return!1;if(t.__proto__===[].__proto__)return!1;if((Object.prototype===t.__proto__||Error.prototype===t.__proto__)&&t instanceof Object)return!0;if(void 0!==t.__proto__)try{return t instanceof Object}catch(t){return!1}return!!t.prototype},z=function(t){var e;return void 0===t&&(t=[]),(e=t.filter((t,e,r)=>r.indexOf(t)===e))instanceof Array?e:[]},H=function(t,e){return void 0===e&&(e=void 0),(!N(e)||x(e))&&!!t&&void 0!==t.prototype},K=function(t){void 0===t&&(t=/\\/);try{return t instanceof RegExp}catch(t){return!1}},X=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e=void 0),N(e)&&!x(e))return!1;if(!t)return!1;if(L(t))return!1;if(t.__proto__&&!H(t))try{return t.__proto__ instanceof Object}catch(t){return!1}return!1},G=function(t){return void 0===t&&(t={}),t&&isNaN(+t)&&(X(t)||Object.prototype===t.__proto__||Error.prototype===t.__proto__)?Object.keys(t).length:0},Y=function(t){return void 0===t&&(t=void 0),null==t||!1===t&&"boolean"==typeof t||(!0!==t||"boolean"!=typeof t)&&!("number"==typeof t&&0<t)&&(n===t.__proto__?1>t.length:Array.prototype===t.__proto__?0===(t||[]).length:Promise.prototype!==(t||{}).__proto__&&"function"!=typeof t&&(Object.prototype===t.__proto__||X(t)?0===Object.keys(t).length:Error.prototype!==t.__proto__&&(void 0!==t&&t.__proto__===s?!!isNaN(t)||0>=t:0==0<+t||!t&&!1)))},Z=function(t,e){return void 0===t&&(t=void 0),void 0===e&&(e=void 0),(!N(e)||x(e))&&null!=t&&"boolean"!=typeof t&&(""===t||n===t.__proto__)},tt=t=>{try{return JSON.parse(JSON.stringify(t))}catch(e){return B(t).primitiveValue}},et=w(function(t){function e(t,i,s,n,o){var a;return c(this,e),a=r.call(this,i,s,n),0<W(t)&&(a.name=t),"string"!=typeof s||a.fileName||(a.fileName=s),"number"==typeof n&&void 0===a.lineNumber&&(a.lineNumber=n),"number"==typeof o&&void 0===a.columnNumber&&(a.columnNumber=o),a}h(e,t);var r=l(e);return e}(p(ReferenceError))),rt=function(t){return void 0===t&&(t={name:"ReferenceError",message:void 0,fileName:void 0,lineNumber:void 0,columnNumber:void 0}),new et(t.name,t.message,t.fileName,t.lineNumber,t.columnNumber)},it=w(function(t){function e(t,i,s,n,o){var a;return c(this,e),(a=r.call(this,s,n,o)).id=void 0,a.name=void 0,"string"==typeof n&&void 0===a.fileName&&(a.fileName=n),"number"==typeof o&&void 0===a.lineNumber&&(a.lineNumber=o),a.name=W(t)?t:"XError",(Z(i)||V(i))&&(a.id=i.toString()),a}h(e,t);var r=l(e);return e}(p(Error))),st=t=>{try{return!(Error.prototype!==(t||"").__proto__)||t instanceof Error||t instanceof et}catch(t){return!1}},nt=(t,e)=>J(t)&&e&&(e||[]).length?Object.entries(t).reduce((t,r)=>{var[i,s]=r;return e.filter(t=>t===i).length&&(t[i]=s),t},{}):{};e.disableLogging=()=>{try{if(D())return window.xUtilsConfig?window.xUtilsConfig.logging="off":window.xUtilsConfig={logging:"off"},!0}catch(t){}try{return r.xUtilsConfig?r.xUtilsConfig.logging="off":r.xUtilsConfig={logging:"off"},!0}catch(t){return!1}},e.resetLogging=()=>{try{if(D())return window.xUtilsConfig?window.xUtilsConfig.logging="on":window.xUtilsConfig={logging:"on"},!0}catch(t){}try{return r.xUtilsConfig?r.xUtilsConfig.logging="on":r.xUtilsConfig={logging:"on"},!0}catch(t){return!1}},e.loggerSetting=function(t,e){if(void 0===t&&(t="log"),void 0===e&&(e="off"),!["log","warn","onerror","error","alert","attention","debug","stack","errorTrace"].includes(t)||!t)return!1;if(!["on","off"].includes(e)||!e)return!1;"onerror"===t&&(t="error");try{if(D())return window.xUtilsConfig?window.xUtilsConfig[t]=e:window.xUtilsConfig={[t]:e},!0}catch(t){}try{return r.xUtilsConfig?r.xUtilsConfig[t]=e:r.xUtilsConfig={[t]:e},!0}catch(t){return!1}},e.checkLoggerSetting=O,e.stack=function(t,e){if(void 0===e&&(e=!1),P()&&"off"!==O("stack")){var r=new Error(JSON.stringify(t)).stack.split("(");r.splice(1,1);var i=r[0].split(/\n/)[0].replace("Error","[STACK TRACE]");return r.splice(0,1),r.unshift(i),void(e?console.log(r):console.log.apply(null,r))}},e.errorTrace=function(t,e){if(void 0===e&&(e=!1),P()&&"off"!==O("errorTrace")){var r=new Error(JSON.stringify(t)).stack.split("(");r.splice(1,1);var i=r[0].split(/\n/)[0].replace("Error","[ERROR]");return r.splice(0,1),r.unshift(i),void(e?console.error(r):console.error.apply(null,r))}},e.loop=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=function(t){void 0===t&&(t=0)}),"function"!=typeof e||"number"!=typeof t)return[];for(var r,i=[],s=0;s<Array(t).length;s++){r=e.apply(this,[s]);try{if(r&&Object.entries(r).length&&r.break)break}catch(t){}i.push(r)}return i},e.isFalse=t=>{if(null===t)return!0;if(void 0===t)return!0;if("number"==typeof t&&1>t)return!0;if("boolean"==typeof t&&!1===t)return!0;try{if(t instanceof Boolean)return!1===t.valueOf()}catch(t){}return!1},e.isTrue=t=>{if(null===t)return!1;if(void 0===t)return!1;if("number"==typeof t&&0<t)return!0;if("boolean"==typeof t&&!0===t)return!0;try{if(t instanceof Boolean)return!0===t.valueOf()}catch(t){}return!1},e.isBoolean=F,e.isNull=R,e.isUndefined=U,e.isEmpty=t=>!st(t)&&!B(t).value,e.head=function(t){return void 0===t&&(t=[]),Array.prototype===(t||null).__proto__?t.flat().shift():void 0},e.last=function(t){return void 0===t&&(t=[]),t&&Array.prototype===t.__proto__?t[t.length-1]:void 0},e.timer=function(t,e){if(void 0===t&&(t=()=>{}),void 0===e&&(e=0),"function"==typeof t){e="number"==typeof e&&0<=e?e:0;var r=setTimeout(()=>{t(),clearTimeout(r)},e)}},e.interval=function(t,e,r){if(void 0===t&&(t=()=>{}),void 0===e&&(e=0),void 0===r&&(r=0),"function"!=typeof t)return null;e="number"==typeof e&&0<=e?e:0,r="number"==typeof r&&0<=r?r:0;var i=0,s=setInterval(()=>(t(),r<=i?clearInterval(s):void(i+=e)),e)},e.sq=()=>{var t=w(function(t){function e(t){var r;return void 0===t&&(t=function(t,e){void 0===t&&(t=()=>{}),void 0===e&&(e=()=>{})}),c(this,e),(r=s.call(this,t))._progress_cb={every:100,timeout:1e3,cb:void 0,done:void 0,index:0},r}h(e,t);var r,i,s=l(e);return r=e,(i=[{key:"progress",value:function(t,e,r){void 0===e&&(e=100),void 0===r&&(r=1e3),e>r&&(e=0);var i=0;this._progress_cb.cb=t,this._progress_cb.every=e,this._progress_cb.timeout=r,this._progress_cb.index=i;var s=setInterval(()=>(this._progress_cb.index=i,this._progress_cb.done?clearInterval(s):i>=r?(this._progress_cb.cb("timeout",i),this._progress_cb.done=!0,clearInterval(s)):(this._progress_cb.cb("in_progress",i),void(i+=e))),e);return this}},{key:"resolve",value:function(t){var r=e._resolve;return r instanceof Function?(r(t),N(this._progress_cb.cb)&&!this._progress_cb.done&&(this._progress_cb.cb("resolved",this._progress_cb.index),this._progress_cb.done=!0)):A("[SimpleQ][resolve]","not callable"),this}},{key:"reject",value:function(t){var r=e._reject;return r instanceof Function?(r(t),N(this._progress_cb.cb)&&!this._progress_cb.done&&(this._progress_cb.cb("rejected",this._progress_cb.index),this._progress_cb.done=!0)):A("[SimpleQ][reject]","not callable"),this}},{key:"promise",get:function(){var t=e._promise;return t instanceof Promise?t:void 0}}])&&u(r.prototype,i),e}(p(Promise))),e=t._promise=new t((e,r)=>{t._resolve=e,t._reject=r});if(e.__proto__.entity="SimpleQ",e instanceof Promise&&e instanceof t)return e;throw"sq() not a valid Promise ?"},e.validID=function(t){return void 0===t&&(t=""),t?(t||"").toString().toLowerCase().replace(/\s/g,""):""},e.isBigInt=E,e.isNumber=V,e.stringSize=W,e.cancelPromise=t=>{var{defer:e,checkEvery:r=500,maxWait:i=9500,cbErr:s=(t=>{var{error:e,defer:r,id:i}=t}),message:n="taken too long to respond",logging:o=!1,id:a}=t;if(!Q(e)&&!q(e)||"function"!=typeof s||!i)return A("[cancelPromise]","{defer,maxWait,cbErr} must be provided"),Promise.reject("{defer,maxWait,cbErr} must be provided");var c,u=r||500;i=i||1;var h=0,l=setInterval(()=>{if(c)return clearInterval(l);if(h>i){var t={error:n+", time: "+h,defer:e,id:a};try{s.apply(t,[t]),e.reject(n+", time: "+h)}catch(t){A("[cancelPromise]",t)}return clearInterval(l)}o&&(a?$("-- processing: ",a):C("-- processing ")),h=u+h},u),d=t=>t.then(t=>(c=!0,t),t=>(c=!0,Promise.reject(t)));return M(e)||Q(e)&&!q(e)?d(e):q(e)?d(e.promise):Promise.reject("[cancelPromise], Supplied {defer} is not a promise")},e.shuffle=function(t){var e=Math.floor;if(void 0===t&&(t=[]),!L(t))return[];for(var r=t.length-1;0<r;r--){var i=e(Math.random()*r),s=t[r];t[r]=t[i],t[i]=s}return t},e.selectiveArray=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=[]),!L(e))return[];if(!e.length)return[];if(!L(t))return e;if(!t.length)return e;t=z(t);for(var r,i=[],s=function t(e,r,i){var s;if(void 0===i&&(i=0),e&&L(e)&&e.length){try{if(void 0!==r[e[i]])return s=r[e[i]],e[++i]?t(e,s,i):s}catch(t){console.log(t.toString())}return s}},n=0;n<e.length;n++)if(r=e[n],J(r)){for(var o,a=void 0,c=[],u=0;u<t.length;u++){o=(t[u]||"").split(".");try{a=s(o,r,0),c.push(a)}catch(t){}}t.length===c.length&&c.filter(t=>void 0===t).length===t.length&&(c=c.filter(t=>!!t)),c.length?i.push([].concat(c)):void 0!==a&&i.push(a)}else i.push([r]);return i},e.hasPrototype=H,e.hasProto=function(t,e){if(void 0===e&&(e=void 0),N(e)&&!x(e))return!1;try{return void 0!==t.__proto__}catch(t){return!1}},e.objectSize=G,e.isString=Z,e.isFunction=N,e.copyBy=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e=[]),!J(t))return{};var r=[].concat(e).reduce((e,r)=>(void 0!==t[r]&&(e[r]=t[r]),e),{});try{return JSON.parse(JSON.stringify(r))}catch(t){return{}}},e.copyDeep=t=>{if(L(t))return t.map(t=>tt(t));if(J(t))return Object.entries(t).reduce((t,e)=>{var[r,i]=e;return t[r]=J(i)?Object.assign({},tt(i)):i,t},{});try{return JSON.parse(JSON.stringify(t))}catch(e){return B(t).primitiveValue}},e.delay=function(t){return void 0===t&&(t=0),"number"==typeof t&&0<=t?new Promise(e=>{var r=setTimeout(()=>{clearTimeout(r),e(!0)},t)}):Promise.resolve(!0)},e.someKeyMatch=function(t,e,r){if(void 0===t&&(t={}),void 0===e&&(e={}),void 0===r&&(r=void 0),N(r)&&!x(r))return!1;if(!t||Object.prototype!==t.__proto__)return!1;if(!e||Object.prototype!==e.__proto__)return!1;var i=Object.keys(t),s=Object.keys(e);return i.length>=s.length?0<i.filter(t=>s.filter(e=>e===t).length).length:0<s.filter(t=>i.filter(e=>e===t).length).length},e.exactKeyMatch=function(t,e,r){if(void 0===t&&(t={}),void 0===e&&(e={}),void 0===r&&(r=void 0),N(r)&&!x(r))return!1;if(!t||Object.prototype!==t.__proto__)return!1;if(!e||Object.prototype!==e.__proto__)return!1;var i=Object.keys(t),s=Object.keys(e);return i.length>=s.length?i.filter(t=>s.filter(e=>e===t).length).length===i.length:s.filter(t=>i.filter(e=>e===t).length).length===s.length},e.trueVal=function(t){return void 0===t&&(t=[]),t&&Array.prototype===t.__proto__?[].concat(t).filter(t=>!0!==Y(t)):[]},e.trueValDeep=function(t){return void 0===t&&(t=[]),t&&Array.prototype===t.__proto__&&t.length?[].concat(t).map(t=>{var e=B(t,!1);return"array"===e.type&&0<e.value?t.map(t=>0<B(t,!1).value?t:null).filter(t=>!!t):"object"===e.type&&e.value?Object.entries(t).reduce((t,e)=>{var[r,i]=e;return 0<B(r,!1).value&&(t[r]=i),t},{}):0<e.value?t:null}).filter(t=>!!t):[]},e.trueProp=function(t){return void 0===t&&(t={}),t&&Object.prototype===t.__proto__?Object.entries(t).reduce((t,e)=>{var[r,i]=e;return Y(i)||(t[r]=i),t},{}):{}},e.resolver=function(t,e,r){return void 0===t&&(t=()=>{}),void 0===e&&(e=5e3),void 0===r&&(r=50),"function"==typeof t?new Promise(i=>{var s,n=r||50,o=e,c=0,u=(s=a((function*(){try{return yield t()}catch(t){return st(t)?{error:t}:J(t)&&t.error?t:{error:t}}})),function(){return s.apply(this,arguments)}),h=setInterval(a((function*(){var t=u();if(t.catch(t=>t),c>=o)return(t||{}).resolve&&t.resolve(void 0),i(void 0),clearInterval(h);c+=n;try{c+=n;var e=yield t;if(e)return i(e),clearInterval(h)}catch(t){return st(t)&&i(t),J(t)&&t.error?i(t):i({error:t}),clearInterval(h)}})),n)}):Promise.reject("fn() must be callable")},e.flatten=function(t){return void 0===t&&(t=[]),L(t)?[].concat(...t):[]},e.flattenDeep=function(t){void 0===t&&(t=[]);var e=[];if(!L(t))return e;try{return(e=function t(e,r){return void 0===r&&(r=1),0<r?e.reduce((e,i)=>e.concat(Array.isArray(i)?t(i,r-1):i),[]):e.slice()}(t,1/0)||[])instanceof Array?e:[]}catch(t){return[]}},e.chunks=function(t,e){var r=Math.ceil;return void 0===t&&(t=[]),void 0===e&&(e=0),Array.from({length:r(t.length/e)},(r,i)=>t.slice(i*e,i*e+e))},e.dupes=function(t,e){void 0===e&&(e=0);for(var r=[],i=parseInt(e);0<i;)i--,r.push(t);return r},e.uniqBy=function(t,e){void 0===t&&(t=[]),void 0===e&&(e="");var r={},i=[];if(!e)return[];if(!(t||[]).length)return[];for(var s=function(s){var n=t[s];return U(n)||R(n)?(i.push(n),"continue"):J(n)?void 0===n[e]?(i.push(n),"continue"):Object.entries(r).filter(t=>{var[i]=t;return n[e]===r[i]}).length?"continue":void(n[e]!==r[e+":"+s]&&(r[e+":"+s]=n[e],i.push(n))):(i.push(n),"continue")},n=0;n<t.length;n++)s(n);return i},e.arrayWith=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=""),!L(t))return[];try{var r=t.map(t=>(t=>J(t)?-1===Object.keys(t).indexOf(e)?void 0:t:void 0)(t)).filter(t=>!!t);return r instanceof Array?r:[]}catch(t){return[]}},e.exFromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);try{if(!(t instanceof Array))return[]}catch(t){return[]}if(!(e=[].concat(e)).length)return t;try{var r=t.map(t=>function(t,e){if(void 0===t&&(t={}),void 0===e&&(e=[]),!J(t))return t;var r=Object.entries(t).reduce((t,r)=>{var[i,s]=r;return-1===e.indexOf(i)&&(t[i]=s),t},{});return Y(r)?void 0:r}(t,e));return r instanceof Array?r:[]}catch(t){return[]}},e.copy=tt,e.uniq=z,e.isPromise=Q,e.isQPromise=q,e.debug=function(){if(P()&&"off"!==O("debug")){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return S("debug",e)}},e.log=$,e.warn=I,e.onerror=A,e.error=T,e.alert=C,e.attention=function(){if(P()&&"off"!==O("attention")){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return S("attention",e)}},e.isObject=J,e.isFalsy=Y,e.isError=st,e.typeCheck=B,e.validDate=function(t,e){if(void 0===e&&(e=void 0),N(e)&&!x(e))return!1;try{return t.__proto__===Date.prototype&&"Invalid Date"!==t.toString()}catch(t){return!1}},e.isInstance=X,e.isClass=H,e.isArray=L,e.arraySize=function(t){void 0===t&&(t=void 0);var e=0;return L(t)?e=t.length:e},e.pickFromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=[];try{if(!(t instanceof Array))return r}catch(t){return[]}if(L(e)||(e=[].concat(e)),!e.length)return t;var i=[void 0,null,!1];if(!(e=e.filter(t=>!Y(t)||i.filter(e=>e===t||(V(t)&&!isNaN(t)).length))).length)return t;var s=(t,e)=>{if(L(t)&&N(e)){if("object"===e.name.toLowerCase())return!1;if("array"===e.name.toLowerCase())return!0}if(J(t)&&N(e)){if("array"===e.name.toLowerCase())return!1;if("object"===e.name.toLowerCase())return!0}try{return(e.name||"").toLowerCase()===typeof t}catch(t){}};try{return(r=t.reduce((t,r)=>((t=>{for(var r,i,n=0;n<e.length;n++){if(i=e[n],J(i)&&J(t)){var o=Object.entries(i),a=o.filter(e=>{var[r,i]=e;return!(t[r]!==i)||(void 0===t[r]?void 0:s(t[r],i))});if((a=a.length===o.length&&Object.entries(t).length>=a.length)&&G(t)>=G(i)){r=!0;break}}if(L(i)&&L(t)){var c=i.filter(e=>t.filter(t=>t===e||s(t,e)).length);if(c=c.length===i.length&&t.length>=c.length){r=!0;break}}else{if(i===t){r=!0;break}if(V(t)||F(t)||Z(t)||L(t)||J(t)||N(t)){if(s(t,i)){r=!0;break}}else if(s(t,i)){r=!0;break}}}return r})(r)&&t.push(r),t),[]))instanceof Array?r:[]}catch(t){return[]}},e.dispatcher=function(t,e){return void 0===t&&(t=void 0),void 0===e&&(e=!1),new _(t,e)},e.isSQ=M,e.withHoc=function(t){void 0===t&&(t=()=>{});for(var e=arguments.length,r=Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var s=r,n=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];var n=()=>s?[].concat(r,s):r;if(t instanceof Function)try{return t(...n())}catch(t){A("[HOC]",t)}else{if(Q(t))return(t.promise?t.promise:t).then(t=>N(t)?t(...n()):Promise.reject("DEFERRED_NOT_CALLABLE"),t=>N(t)?Promise.reject(t(...n())):Promise.reject("DEFERRED_NOT_CALLABLE"));A("[HOC]","item() must be callable function")}};return n},e.isDate=t=>{try{return t instanceof Date}catch(t){return!1}},e.xrequire=function(e,r,i){if(void 0===e&&(e=""),void 0===r&&(r=""),!D()){var s=function(){};return(s.prototype=Object.create(t.constructor.prototype)).constructor=t.constructor,s.prototype.require=function(t,e){try{var i=0!==t.indexOf("./")&&0!==t.indexOf("."),s=t;if(!r&&"ERR_NO_THROW"===e&&!i)return;if(!r&&"ERR_NO_THROW"!==e&&!i)throw rt({name:"xrequire",message:"xrequire needs your __dirname to correctly map the path to require script"});if(!i){var n=r.replace(/\\/g,"/");-1===t.indexOf("..")&&-1!==t.indexOf("./")&&(t=t.replace("./","")),s=n+"/"+t}return this.constructor._load(s,this)}catch(t){if("xrequire"===t.name)throw t.message;if("ERR_NO_THROW"===e)return;if("MODULE_NOT_FOUND"===t.code)throw t.stack}},s.prototype instanceof t.constructor?s.prototype.require(e,i):void 0}},e.asJson=t=>{try{return JSON.stringify(t,null,2)}catch(t){return"[asJson], "+t.toString()}},e.truthFul=function(t){return void 0===t&&(t={}),J(t)?Object.entries(t).reduce((t,e)=>{var[r,i]=e;return void 0!==i&&(t[r]=i),t},{}):{}},e.inIndex=function(t,e){void 0===t&&(t="");var r=0;return L(e)&&e.length?"string"!=typeof t?r:t?r=e.filter((e,r)=>((t,e,r)=>{try{return new RegExp(t).test(e)}catch(t){return A("[inIndex]","wrong pattern/expression at index:"+r),!1}})(e,t,r)).length:r:r},e.isRegExp=K,e.matched=function(t,e){void 0===t&&(t=""),void 0===e&&(e=/\\/);var r=!1;return Z(t)&&K(e)?"string"!=typeof t?r:t?r=((t,e)=>{try{return new RegExp(t).test(e)}catch(t){return A("[matched]",t.toString()),!1}})(e,t):r:r},e.referenceError=rt,e.xError=function(t){return void 0===t&&(t={name:"XError",id:void 0,message:void 0,fileName:void 0,lineNumber:void 0}),new it(t.name,t.id,t.message,t.fileName,t.lineNumber)},e.noop=()=>{},e.trim=t=>"string"==typeof t?t.replace(/(\r\n?|\n|\t)/g,"").trim().replace(/\s\s +/g," "):"",e.includes=(t,e)=>!!L(e)&&0<e.filter(e=>t===e).length,e.unsubscribe=(t,e)=>{if(!(t||[]).length)return 0;var r=0;return t.forEach(t=>{try{void 0!==t.unsubscribe&&(t.unsubscribe(),r++)}catch(t){}}),t.splice(0,t.length),r&&$("unsub "+(e?"from:"+e:"")+" index: "+r),r},e.objectIterateWith=(t,e)=>nt(t,e),e.spread=nt,e.spreadWith=(t,e)=>{if(!(t||[]).length)return[];if(!(e||[]).length)return[];for(var r,i=[],s=0;s<e.length;s++)"number"==typeof(r=e[s])&&void 0!==t[r]&&i.push(t[r]);return i}},n=[t,e],void 0===(o="function"==typeof(s=a)?s.apply(e,n):s)||(t.exports=o)}).call(this,r(4),r(5))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){var r,i,s=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(t){r=n}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var c,u=[],h=!1,l=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!h){var t=a(d);h=!0;for(var e=u.length;e;){for(c=u,u=[];++l<e;)c&&c[l].run();l=-1,e=u.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new f(t,e)),1!==u.length||h||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,r){const{uniqBy:i,isArray:s}=r(3);t.exports=class{constructor(t,e,r){this._dataBank=[],this.debug=r}set dataBank(t){if(s(t)){if(t.filter(t=>t.data_id).length)return}else if((t||{}).data_id)return;this._dataBank.push({data:t,data_id:(new Date).getTime().toString()}),this._dataBank=this._dataBank.filter(t=>void 0!==t.data)}get dataBank(){return i(this._dataBank||[],"data_id")}}},function(t,e){t.exports=function({data:t,status:e,ref:r,error:i,campaign:s}){this.data=t,this.status=e,this.ref=r,this.error=i,this.campaign=s,Object.entries(this).forEach(([t,e])=>{void 0===e&&delete this[t]})}},function(t,e,r){const{validID:i}=r(3);e.errorMessages=t=>{const e={};for(let[r,i]of Object.entries(t))e[r]={message:i[0],code:r};return e};const s=(t="")=>!new RegExp(/[`~!@#$%^&*()\=?;'",.<>\{\}\[\]\\\/]/gi,"gi").test(t);e.validProjectID=(t="")=>{if(t&&!((t||"").split(" ").length>1)&&s(t))return t},e.validProbe=(t="")=>{if((t=i(t))&&s(t)&&-1!==t.indexOf("::"))return t},e.idRegexValid=s},function(t,e,r){const{validProjectID:i}=r(8),{objectSize:s,isFunction:n,onerror:o,warn:a,isString:c}=r(3),u=r(10),h=r(11);t.exports=class extends h{constructor(t,e){super(t,e),this.architectConfig={};const r=new u;this.architectMod=r.architect}setArchitect(t,e){return void 0===this.architectConfig[t]&&(this.architectConfig[t]=this.architectMod),this.architectConfig[t].value=Object.assign({},this.architectConfig[t].value,e),this}getArchitect(t){return(this.architectConfig[t]||{}).value}asset(t,e,r){if(!n(e))return this.debug&&a("[pocket]","[$asset] asCallback must be a function"),null;if("project"===t||"cache"===t)return void(this.debug&&a("[pocket]","[$asset] 'project, cache' are  restricted"));const s=this.lastProjectID(r);return r=i(s||r),this.getArchitect(r)?void 0!==this.getArchitect(r)[t]?e.call(this,this.getArchitect(r)[t]):(this.debug&&a("[pocket]","[$asset] assetName for architect doesnt exist"),null):(this.debug&&a("[pocket]","[$asset] architectConfig for assetName doesnt exist"),null)}architect(t,e){if(!n(t))return this.debug&&o("[pocket]","[$architect] callback must be set"),this;const r=t.call(this);if(!s(r))return this.debug&&o("[pocket]","[architect] must return a valid object settings {project, asset}, at least 1 is required"),this;const u=(r.project||{}).id,h=this.lastProjectID(e);if(!(e=i(h||e||u)))return this.debug&&o("[pocket]","[$architect] if this is a new project, you must specify projectID"),this;const l=Object.entries(r).reduce((t,[e,r])=>(-1!==["project","asset","cache"].indexOf(e)&&(t[e]=r),t),{});if((this.getArchitect(e)||{}).cache)l.cache=this.getArchitect(e).cache;else{const t={project:!1,asset:!1};l.cache||(l.cache=t),this.setArchitect(e,{cache:l.cache})}for(let t in l){const r=l[t],i=!0===l.cache[t]&&("project"===t||"asset"===t);if("project"===t){try{if(i&&this.getArchitect(e)[t])continue}catch(t){}this.setArchitect(e,{project:this.$payload(r,r.async,r.type).d})}if("asset"===t){if(!c(r.name)||void 0===r.value)return this.debug&&a("[pocket]","[$architect] asset must include {value, name}"),this;if("project"===r.name||"cache"===r.name)return this.debug&&a("[pocket]",'[$architect] asset props, "project, cache" are reserved'),this;try{if(i&&this.getArchitect(e)[r.name])continue}catch(t){}this.setArchitect(e,{[r.name]:r.value})}}return this}}},function(t,e,r){const{objectSize:i,log:s}=r(3);t.exports=function t(){this._architectVal=null,this.architect=Object.create(t.prototype,{value:{enumerable:!0,configurable:!0,get:()=>this._architectVal,set:t=>{i(t)&&(this._architectVal=t,s("[pocket]","[architect] updated"))}}})}},function(t,e,r){r(2),r(12);const{onerror:i,warn:s,isPromise:n,validID:o,isString:a}=r(3),c=r(14);t.exports=class extends c{constructor(t,e){super(t,e),this.$project=this.$payload}deletePocketSet(t){if(t){if(Object.values(this.pocket).length)for(let e of Object.values(this.pocket))this._$cached_data[e.id]&&delete this._$cached_data[e.id],e.id.includes(t)&&delete this.pocket[e.id];this.payloadData[t]&&delete this.payloadData[t],this._ready[t]&&delete this._ready[t],void 0!==this._projectSetDispatcher[t]&&delete this._projectSetDispatcher[t],this._projectSetAsync[t]&&delete this._projectSetAsync[t],this._lastFilterList[t]&&delete this._lastFilterList[t];try{this.architectConfig[t]&&delete this.architectConfig[t]}catch(t){}this.clearStoreTransfers(t)}}$removeProject(t){return t=a(t)?t:"",t=this.lastProjectID(t),this.deletePocketSet(t),this}$payload(t,e,r){const s=t=>(this.d=t,this),o=void 0!==e?e:this.async;return o&&n(t)?s(t.then(t=>this.payload(t,!1,r),t=>t)):o||n(t)?(this.debug&&i("[pocket]","[payload] with opts.async=true, data must be a promise, or do not set async when not a promise"),s(!!o&&Promise.reject())):s(this.payload(t,!1,r))}$ready(t,e=!1){try{const r=t=>(this.d=t,this.d&&!e&&this.d.catch(t=>{this.disableWarnings||s("[pocket]",t)}),this);let i=this.lastProjectID(t,!1,null);if(!t&&i&&(t=i),"complete"===this.projectsCache[t]&&!e)return r(Promise.reject(`[$ready] project: ${t} already complete`));if(void 0!==this._ready_method_set[t]&&!e){if(!0===this._ready_method_set[t])return r(Promise.reject(`[$ready] project: ${t} already complete, cannot recall same $ready, ALLOW_MULTIPLE_FALSE`));if(!1===this._ready_method_set[t])return r(Promise.reject(`[$ready] project: ${t} you already declared $ready somewhere else, this call is ignored, ALLOW_MULTIPLE_FALSE`))}if(!i)throw"payloadID must be set";const n=this.$projectSetAsync(i).then(({projectID:t})=>this.ready(t).then(e=>(this.deleteWithDelay?setTimeout(()=>{this.deletePocketSet(t)},this.deleteWithDelay):this.deletePocketSet(t),this.projectsCache[t]="complete",this._ready_method_set[i]=!0,e),Promise.reject),Promise.reject);return this._ready_method_set[i]=!1,r(n)}catch(t){this.disableWarnings||i("[pocket]",t)}}}},function(t,e,r){const i=r(13),{validProjectID:s}=r(8),{isArray:n,isString:o}=r(3);t.exports=function({id:t="",tasks:e=[]}){if(!t||!o(t)||!s(t))throw"ProjectPayloadModel/invalid id provided";if(!n(e)||!(e||[]).length)throw"ProjectPayloadModel/invalid tasks[] provided";this.id=t,this.tasks=e.map(t=>new i(t))}},function(t,e){t.exports=function({id:t,ref:e,task:r,campaign:i,data:s}){this.id=t,this.ref=e,this.task=r,this.campaign=i,this.data=s,Object.entries(this).forEach(([t,e])=>{void 0===e&&delete this[t]})}},function(t,e,r){const i=r(12),s=r(7),{idRegexValid:n}=(r(2),r(8)),{sq:o,objectSize:a,log:c,onerror:u,warn:h,isObject:l,validID:d}=r(3),p=r(15);t.exports=class extends p{constructor(t,e){super(t,e),this.dispatcher&&this.dispatcher.subscribe((t,e)=>{const{probe:r,status:i}=t||{};"error"===i&&this.debug&&c("[pocket]",`[dispatcher] probe id:${r.id} error`),"open"===i&&this.debug&&c("[pocket]",`[dispatcher] probe id:${r.id} created`),"complete"===i&&this.debug&&c("[pocket]",`[dispatcher] probe id:${r.id} completed`)})}payload(t,e,r="new"){try{t=new i(t)}catch(t){return u("[payload]",t),!1}this.d=null;let s=null;if(this.payloadData[t.id]&&(!r||"new"===r))return this._lastProjectID=t.id,!0;let o=void 0===this.payloadData[t.id];(this._lastFilterList[t.id]||[]).length&&(this._lastFilterList[t.id]=[]);for(let e of t.tasks){if(!e.task){this.debug&&h("[pocket]","[$payload] task must be set for your tasks");continue}if(!n(e.task)||-1!==e.task.indexOf("::")){this.debug&&h("[pocket]","[$payload] invalid taskName, failed idRegexValid validation");continue}const i=`${t.id}::${e.task}`;"update"!==r||o||!this.pocket[i]?(this.payloadData[t.id]||(this.payloadData[t.id]={value:[],status:"open",timestamp:(new Date).getTime()}),this.payloadData[t.id].value.filter(t=>-1!==t.task.indexOf(e.task)).length?this.debug&&!this.disableWarnings&&h("[pocket]",`the same task "${e.task}" already exists on the payload, you must choose uniq`):(this.payloadData[t.id].value.push(e),this.lastPocketTimestamp=this.payloadData[t.id].timestamp)):(e.data&&(this.pocket[i].data=e.data),e.status&&(this.pocket[i].status=e.status),!e.status&&e.data&&"open"===this.pocket[i].status&&(this.pocket[i].status="updated"),e.ref&&(this.pocket[i].ref=e.ref),e.error&&(this.pocket[i].error=e.error),e.campaign&&(this.pocket[i].campaign=e.campaign),s=!0,this._lastProjectID=t.id)}return"update"===r&&this.payloadData[t.id]&&!o?(this.projectsCache[t.id]="open",s):!!this.payloadData[t.id]&&(this.lastProjectID(t.id),this.projectsCache[t.id]="open",this.distributor().setDefer(t.id),this.projectSetDispatcher(t.id).next({projectID:t.id}),!0)}$projectSetAsync(t=""){const e=this;return t=this.lastProjectID(t,!1,null),this._projectSetAsync[t]||(this._projectSetAsync[t]=o(),this.projectSetDispatcher(t).subscribe((function(t,r){e._projectSetAsync[r].resolve(t),this.del()}))),this._projectSetAsync[t].promise}probeStatusAsync(t=""){return(t=>(this.d=t,this))((t=this.lastProbeID(t))?this.pocket[t].getStatusAsync:null)}update(t,e=null,r){return this._setUpdate(t,e,r,"update")}_set(t,e){return this._setUpdate(t,null,e,"set")}_get(t="",e){return this.d=null,(t=>(this.d=t,e?this:this.d))((t=this.lastProbeID(t))?this.pocket[t]:null)}$activeTasks(t=""){const e=t=>(this.d=t,this);return t=this.lastProjectID(t),a(this.pocket)?e(Object.entries(this.pocket).reduce((e,[r,i])=>(0===r.indexOf(t||"")&&t&&this.payloadData[t]?e.push(i.task):t||e.push(i.task),e),[])):e([])}ready(t=""){if(this.d=null,!this._ready[t])throw"ready[payloadID] is not set, maybe you called it before $payload()";return this._ready[t].promise}_setUpdate(t,e=null,r="",i="update"){t=new s(t);const n=t=>(this.d=t,this);let o=this.lastProbeID(r);if(!o)return this.debug&&u("[pocket]","[$update] must specify id"),n(!1);if(!a(t))return this.debug&&h("[pocket]","[$update] dataFrom{} must not be empty"),n(!1);if(!this.pocket[o])return this.debug&&u("[pocket]",`[$update] this.pocket with id:${o} not found`),n(!1);let c=!1;this._lastProjectID=o;let l=Object.entries(t).reduce((t,[e,r])=>{const i=this.probeProps.indexOf(e);return this.probeProps[i]===e&&t.push({inx:i,data:{[e]:r}}),t},[]);for(let t=0;t<l.length;t++){if(void 0===(l[t]||{}).data)continue;const[r,i]=Object.entries(l[t].data)[0];void 0===this.pocket[o][r]?this.debug&&h("[pocket]",`[$update] not a valid prop/value: { ${r}:${this.pocket[o][r]} }`):("data"===r&&(this.pocket[o][r]=!0===e?Object.assign({},this.pocket[o][r],i):i),"status"!==r&&"ref"!==r&&"error"!==r&&"campaign"!==r||(this.pocket[o][r]=i),c=!0)}return c&&"set"===i&&(this.clearStoreTransfers(o),this.$transfer_lastID===o&&(this.$transfer_lastID=""),this._$cached_data[o]&&delete this._$cached_data[o]),n(c)}setDefer(t){if(!(t=d(t)))throw"id must be set";if(this._ready[t]||(this._ready[t]=o()),!a(this.pocket)){const e="[setDefer] probe is empty, so nothing set, id:"+t;return this.debug&&u("[pocket]",e),void this._ready[t].reject(e)}const e=Object.values(this.pocket).filter(e=>-1!==e.id.indexOf(t));if(!e.length){const e=`[setDefer] no pocketSet found for id:${t} `;return this.debug&&u("[pocket]",e),void this._ready[t].reject(e)}try{const r=t=>{const e={};if(!l(t))return null;for(let r=0;r<this.probeProps.length;r++){const i=this.probeProps[r];void 0!==t[i]&&null!==t[i]&&(e[i]=t[i])}return e};return Promise.all(e.map(t=>t.sq.promise)).then(e=>{const i=e.map(t=>r(t.probe)).filter(t=>!!t);this._ready[t].resolve(i)},t=>{u("[pocket]","[setDefer] Promise.all",t)}),!0}catch(t){u("[pocket]","[setDefer]",t)}return!1}distributor(){for(let[t,e]of Object.entries(this.payloadData))if(!(this.lastPocketTimestamp>e.timestamp)&&"complete"!==e.status&&"send"!==e.status&&"error"!==e.status)for(let r of e.value.values()){const e={id:t,...r};this.setProbe(e)||u("[pocket]",`probe for id:${t} already exists`)}return this}setProbe(t={}){if(!t.id||!t.task)throw"id and task both must be set";if(!d(t.id))throw"props.id not valid";const e=`${t.id}::${t.task}`;if(this.pocket[e])return this.debug&&c("[pocket]",`[setProbe] probe: ${e} already set`),null;try{t.id=e;const r=null!==this.dispatcher?this._emit.bind(this):null;let i={withDataBank:this.withDataBank,disableWarnings:this.disableWarnings,onChange:this._onChange,emitter:r,completeOnNull:this.completeOnNull};const s=new(0,this.Probe)(t,i,this.debug);this.pocket[e]=s}catch(t){return u("[pocket]",t),null}return this.pocket[e]}_emit(t){if(!t)return null;if(!this.dispatcher)return!1;try{return this.dispatcher.next(t),!0}catch(t){return u("[pocket]","[_emit] dispatcher did not emit"),!1}}}},function(t,e,r){const{objectSize:i,warn:s,onerror:n,dispatcher:o,validID:a,copy:c,log:u,isString:h}=r(3),l=r(16),{validProbe:d,validProjectID:p,idRegexValid:f}=r(8);t.exports=class extends l{constructor(t,e){super(),this.debug=e||!1,this.async=(t||{}).async||null,this._onChange=(t||{}).onChange||null,this.completeOnNull=(t||{}).completeOnNull||null,this.disableWarnings=(t||{}).disableWarnings,this.withDataBank=(t||{}).withDataBank||!1,this.dispatcher=(t||{}).dispatcher?o():void 0,this.pocket={},this.payloadData={},this.lastPocketTimestamp=0,this._lastProjectID=null,this._lastProbeID=null,this._$cached_data={},this.$transfer_lastID="",this._ready={},this._ready_method_set={},this.d=void 0,this._projectSet={},this._transferCached=[],this._projectSetDispatcher={},this._projectSetAsync={},this._lastFilterList={},this.projectsCache={},this.deleteWithDelay=(t||{}).deleteWithDelay||1e3}projectSetDispatcher(t){return t?(this._projectSetDispatcher[t]||this._projectSetDispatcher[t]||(this._projectSetDispatcher[t]=o(t)),this._projectSetDispatcher[t]):(this.debug&&n("[projectSetDispatcher] projectID must be set"),null)}projectProbeList(t){return t?Object.entries(this.pocket).filter(([e])=>0===e.indexOf(t)).map(([t,e])=>e):[]}clearStoreTransfers(t=""){if(!t)return;let e=!1;return this._transferCached.length&&this._transferCached.forEach((r,i)=>{const{fromProbeID:s}=r||{};s&&-1!==s.indexOf(t)&&(this._transferCached.splice(i,1),e=!0,this.debug&&u("[pocket]",`[clearStoreTransfers] transferCached for probeID: ${s} has been removed`))}),e}storeTransfers(t,e){return this._transferCached.push({timestamp:(new Date).getTime(),fromProbeID:t,data:e}),this._transferCached}accessLastValidTransfer(t=100){if(!this._transferCached.length)return{};this._transferCached.sort((t,e)=>t.timestamp-e.timestamp);const e=c(this._transferCached).reduce((e,r,i)=>{const{timestamp:s}=r,n=(new Date).getTime()+t;return n>s&&n-s-t<=t&&(e=r,this._transferCached.splice(i,1)),e},{});return i(e)?e:{}}selectByTask(t="",e=null){if(t=h(t)?t:"",!f(t)&&t)return null;if(t.indexOf(":")>0&&!this.pocket[t])return this.debug&&s("[pocket]","[selectByTask] when using '::' prefix selector, it should come at 0 index"),null;if(t.split(":").length>3||2===t.split(":").length)return this.debug&&s("[pocket]",`[selectByTask] wrong taskName :${t}, allowed prefix is '::taskName'`),null;if(e&&this.lastProbeID(t,!0),this.pocket[t])return e&&this.lastProbeID(t),t;const r=(t=>{const e=t.split("::")[1]||t;return(this._lastProbeID||"").indexOf(e)>0&&e?this._lastProbeID:this._lastProjectID&&e?this._lastProjectID+"::"+e:this._lastProbeID})(t);return r?e&&this.lastProbeID(r):this.debug&&s("[pocket]","[selectByTask] newProbeID was not found from taskOrProbeID: "+t),r}lastProjectID(t="",e=null,r="strict"){return!t&&this._lastProjectID&&(t=this._lastProjectID),t&&(t=p(t)),t&&this.payloadData[t]&&(this._lastProjectID=t),(this.payloadData[t]||"strict"!==r)&&t?(t&&!this._lastProjectID&&(this._lastProjectID=t),t):null}lastProbeID(t="",e=null){return!t&&this._lastProbeID&&(t=this._lastProbeID),t&&(t=d(t)),t&&this.pocket[t]&&(this._lastProbeID=t),t&&this.pocket[t]?t:null}dataPropSelector(t="data()",e="",r={},n=!1,o={}){let a;try{return a=Object.entries(r).reduce((t,[e,r],i)=>(void 0!==o[e]&&(t[e]=o[e]),t),{}),i(a)||(a=void 0),i(a)+i(r)===2&&(a=Object.values(a).shift()),"data()"===t&&(this._$cached_data[e]=a),n?this:a}catch(r){return this.debug&&s("[pocket]","[$data] no dataProp found on probeID: "+e),"data()"===t&&(this._$cached_data[e]=a),n?this:a}}get probeProps(){return["campaign","data","task","ref","error","id","status"]}}},function(t,e,r){t.exports=class{get Probe(){return r(2)}}}]);